// 12 MainActivity
package com.example.task12

import android.os.Bundle
import android.widget.Toast
import androidx.activity.ComponentActivity
import androidx.activity.compose.setContent
import androidx.activity.enableEdgeToEdge
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.Spacer
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.height
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.wrapContentSize
import androidx.compose.material3.Button
import androidx.compose.material3.OutlinedTextField
import androidx.compose.material3.Scaffold
import androidx.compose.material3.Text
import androidx.compose.runtime.Composable
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.runtime.rememberCoroutineScope
import androidx.compose.runtime.setValue
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.platform.LocalContext
import androidx.compose.ui.tooling.preview.Preview
import androidx.compose.ui.unit.dp
import androidx.compose.ui.unit.sp
import com.example.task12.ui.theme.Task12Theme
import kotlinx.coroutines.launch

class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContent {
            val database= UserDatabase.getInstance(this)
            InsertRecord(database)
        }
    }
}

@Composable
fun InsertRecord(database: UserDatabase)
{
    var name by remember { mutableStateOf("") }
    var phonenum: String by remember { mutableStateOf("") }
    var context= LocalContext.current
    val userdao=database.userDAO()
    val scope= rememberCoroutineScope()
    Column(Modifier.fillMaxSize().wrapContentSize(Alignment.Center))
    {
        Text("Enter your Details", fontSize = 20.sp, color = Color.Blue)
        Spacer(Modifier.height(20.dp))
        OutlinedTextField(value = name,
            onValueChange = {name=it},
            label = {Text("Enter name")},
            modifier = Modifier.fillMaxWidth())
        Spacer(Modifier.height(20.dp))
        OutlinedTextField(value = phonenum,
            onValueChange = {phonenum=it},
            label = {Text("Enter phone number")},
            modifier = Modifier.fillMaxWidth())
        Spacer(Modifier.height(20.dp))
        Button(onClick = {
            scope.launch {
                userdao.insert(User(userName = name, userPhone = phonenum))
                Toast.makeText(context,"Row Inasrted", Toast.LENGTH_LONG).show()
            }
        })
        {
            Text("Insert Row")
        }
    }
}





// 12 User.kt in (kotlin+java -> com.example.task12) (DataClass file)
package com.example.task12

import androidx.room.Entity
import androidx.room.PrimaryKey

@Entity(tableName = "CSEG")
data class User(
    @PrimaryKey(autoGenerate = true)
    val uid:Int=0,
    val userName:String,
    val userPhone:String)







// 12 UserDAO.kt in (kotlin+java -> com.example.task12) (interface file)
package com.example.task12

import androidx.room.Dao
import androidx.room.Insert

@Dao
interface UserDAO {
    @Insert
    suspend fun insert(user: User)
}







// 12 UserDatabase.kt in (kotlin+java -> com.example.task12) (class file)
package com.example.task12

import android.content.Context
import androidx.room.Database
import androidx.room.Room
import androidx.room.RoomDatabase

@Database(entities = [User::class], version = 1)
abstract class UserDatabase : RoomDatabase()
{
    abstract  fun userDAO(): UserDAO
    companion object
    {
        private var INSTANCE: UserDatabase? =null
        fun getInstance(context: Context): UserDatabase
        {
            return INSTANCE ?:synchronized(this)
            {
                val instance= Room.databaseBuilder(context.applicationContext,
                    UserDatabase::class.java,
                    "Hanutej_db").build()
                INSTANCE=instance
                instance
            }
        }
    }
}







// 12 build.gradle.kts
plugins {
    alias(libs.plugins.android.application)
    alias(libs.plugins.kotlin.android)
    alias(libs.plugins.kotlin.compose)
    kotlin("kapt")
}

android {
    namespace = "com.example.task12"
    compileSdk = 36

    defaultConfig {
        applicationId = "com.example.task12"
        minSdk = 24
        targetSdk = 36
        versionCode = 1
        versionName = "1.0"

        testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"
    }

    buildTypes {
        release {
            isMinifyEnabled = false
            proguardFiles(
                getDefaultProguardFile("proguard-android-optimize.txt"),
                "proguard-rules.pro"
            )
        }
    }
    compileOptions {
        sourceCompatibility = JavaVersion.VERSION_11
        targetCompatibility = JavaVersion.VERSION_11
    }
    kotlinOptions {
        jvmTarget = "11"
    }
    buildFeatures {
        compose = true
    }
}

dependencies {

    implementation(libs.androidx.core.ktx)
    implementation(libs.androidx.lifecycle.runtime.ktx)
    implementation(libs.androidx.activity.compose)
    implementation(platform(libs.androidx.compose.bom))
    implementation(libs.androidx.compose.ui)
    implementation(libs.androidx.compose.ui.graphics)
    implementation(libs.androidx.compose.ui.tooling.preview)
    implementation(libs.androidx.compose.material3)
    testImplementation(libs.junit)
    androidTestImplementation(libs.androidx.junit)
    androidTestImplementation(libs.androidx.espresso.core)
    androidTestImplementation(platform(libs.androidx.compose.bom))
    androidTestImplementation(libs.androidx.compose.ui.test.junit4)
    debugImplementation(libs.androidx.compose.ui.tooling)
    debugImplementation(libs.androidx.compose.ui.test.manifest)
    val room_version = "2.8.2"

    implementation("androidx.room:room-runtime:$room_version")
    kapt("androidx.room:room-compiler:$room_version")
    implementation("androidx.room:room-ktx:${room_version}")
}